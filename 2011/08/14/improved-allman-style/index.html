
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Improved Allman Style - David Souther</title>
  <meta name="author" content="David Souther <davidsouther@gmail.com>">

  
  <meta name="description" content="C-Based languages are those with “Brace” syntax describing blocks. Since the first C programming texts, there has been something of a holy war &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://DavidSouther.github.io/2011/08/14/improved-allman-style">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/feed.xml" rel="alternate" title="David Souther" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-505666-4']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">David Souther</a></h1>
  
    <h2>Crafstmanship - Software, Hardware, Art, Language</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/feed.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:DavidSouther.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Posts</a></li>
  <li><a href="/about-me/">About</a></li>
  <li><a href="/resume/">Resume</a></li>
  <li><a href="/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Improved Allman Style</h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-08-14T00:35:38-04:00" pubdate data-updated="true">Aug 14<span>th</span>, 2011</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>C-Based languages are those with “Brace” syntax describing blocks. Since the first C programming texts, there has been something of a holy war between zealots of different standards. Being an exemplar of the programming virtue of hubris, I have my entry. Allman-style bracing is the correct, best form for indenting block level code, provided a single addition: the opening brace MUST BE FOLLOWED BY AN INLINE COMMENT. The control statement might tell what the program is doing, but by always including a one-line verbal explanation of the block, other programmers know why the control statement is important. The following is an example mildly complex algorithm from the <a href="http://davidsouther.com/projects/jmtt/tree.js">jmtt analysis demo</a>.</p>

<!-- more -->




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">this</span><span class="p">.</span><span class="nx">calculate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">li</span><span class="p">)</span>
</span><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> * Recursive function to calculate all the scores for a row in our analysis.</span>
</span><span class='line'><span class="cm"> * Gets the weight, grade, and cost from the children, then calcs the weighted</span>
</span><span class='line'><span class="cm"> * average for each middle node. Finally, hands off the data for a second</span>
</span><span class='line'><span class="cm"> * pass determining the target values.</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * Params:</span>
</span><span class='line'><span class="cm"> *   li  HTMLLiNode tree row to calculate for.</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * Returns:</span>
</span><span class='line'><span class="cm"> *   [weight, grade, cost]   Details for the current row.</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">grade</span><span class="p">,</span> <span class="nx">weight</span><span class="p">,</span> <span class="nx">cost</span><span class="p">,</span> <span class="nx">children</span><span class="p">;</span>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="kc">undefined</span> <span class="o">===</span> <span class="nx">li</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>    <span class="c1">//Calcing the entire analysis.</span>
</span><span class='line'>      <span class="nx">children</span> <span class="o">=</span> <span class="nx">tree</span><span class="p">.</span><span class="nx">treetable</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">weight</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>  <span class="p">{</span>    <span class="c1">//Just doing one branch</span>
</span><span class='line'>      <span class="nx">children</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">li</span><span class="p">).</span><span class="nx">children</span><span class="p">(</span><span class="s2">&quot;ul&quot;</span><span class="p">).</span><span class="nx">children</span><span class="p">(</span><span class="s2">&quot;li&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">weight</span> <span class="o">=</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">li</span><span class="p">).</span><span class="nx">children</span><span class="p">(</span><span class="s2">&quot;span.weight:first&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">));</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="nx">children</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>    <span class="c1">//A leaf, floating on the winds...</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">span</span><span class="p">,</span> <span class="nx">input</span><span class="p">;</span>
</span><span class='line'>      <span class="nx">span</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">li</span><span class="p">).</span><span class="nx">children</span><span class="p">(</span><span class="s2">&quot;span.grade&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">input</span> <span class="o">=</span> <span class="nx">span</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
</span><span class='line'>      <span class="nx">grade</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">((</span><span class="nx">input</span> <span class="o">&amp;&amp;</span> <span class="nx">input</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="o">||</span> <span class="nx">span</span><span class="p">.</span><span class="nx">html</span><span class="p">());</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">span</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">li</span><span class="p">).</span><span class="nx">children</span><span class="p">(</span><span class="s2">&quot;span.cost&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">input</span> <span class="o">=</span> <span class="nx">span</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
</span><span class='line'>      <span class="nx">cost</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">((</span><span class="nx">input</span> <span class="o">&amp;&amp;</span> <span class="nx">input</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="o">||</span> <span class="nx">span</span><span class="p">.</span><span class="nx">html</span><span class="p">());</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>  <span class="p">{</span>    <span class="c1">//Weighted average the children.</span>
</span><span class='line'>      <span class="nx">grade</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">cost</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>      <span class="nx">children</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">calc</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">calculate</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">grade</span> <span class="o">+=</span> <span class="p">(</span><span class="nx">calc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nx">calc</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span><span class='line'>          <span class="nx">cost</span> <span class="o">+=</span> <span class="nx">calc</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</span><span class='line'>      <span class="p">});</span>
</span><span class='line'>      <span class="nx">grade</span> <span class="o">/=</span> <span class="mi">100</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">grade</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">rounder</span><span class="p">(</span><span class="nx">grade</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">//Fill in the node.</span>
</span><span class='line'>      <span class="p">((</span><span class="nx">li</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">(</span><span class="nx">li</span><span class="p">).</span><span class="nx">children</span><span class="p">(</span><span class="s2">&quot;span.grade&quot;</span><span class="p">))</span> <span class="o">||</span> <span class="nx">grade_total</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">grade</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;aggregate&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="p">((</span><span class="nx">li</span> <span class="o">&amp;&amp;</span> <span class="nx">$</span><span class="p">(</span><span class="nx">li</span><span class="p">).</span><span class="nx">children</span><span class="p">(</span><span class="s2">&quot;span.cost&quot;</span><span class="p">))</span> <span class="o">||</span> <span class="nx">cost_total</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">cost</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;aggregate&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="kc">undefined</span> <span class="o">===</span> <span class="nx">li</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>    <span class="c1">//At the head, so go back to calculate cost/value</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">_calculate_value</span><span class="p">();</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>  <span class="p">{</span>    <span class="c1">// Pass the aggregate values back up the call chain.</span>
</span><span class='line'>      <span class="k">return</span> <span class="p">[</span><span class="nx">weight</span><span class="p">,</span> <span class="nx">grade</span><span class="p">,</span> <span class="nx">cost</span><span class="p">];</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">_decorate_cells</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">li</span><span class="p">)</span>
</span><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> * Private method to get the row in line with the rest of the table by</span>
</span><span class='line'><span class="cm"> * attaching any remaining cells and setting all the cell styles.</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> * Params:</span>
</span><span class='line'><span class="cm"> *   li  HTMLLiNode with s to apply classes to. */</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">cells</span><span class="p">,</span> <span class="nx">columns</span><span class="p">;</span> <span class="nx">columns</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">columns</span><span class="p">;</span> <span class="nx">cells</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">li</span><span class="p">).</span><span class="nx">children</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">cell_tag</span><span class="p">);</span> <span class="k">while</span><span class="p">(</span><span class="nx">cells</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="nx">columns</span><span class="p">.</span><span class="nx">count</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//Add enough cells to make up for any missing cells in the body that are in the header. $(this.options.cell_tag_html).insertAfter($(li).children(this.options.cell_tag+&quot;:last&quot;)); cells = $(li).children(this.options.cell_tag); } for(i=0; i</span>
</span></code></pre></td></tr></table></div></figure>


<h3>More guidelines</h3>

<pre><code>There are a few other guidelines I follow for consistently readable code.
</code></pre>

<h3>Variable Names</h3>

<pre><code>Variables must be reasonably named to indicate their purpose and contents. Very short, non-word variables should only be used as iterators in for() loops. Projects should choose either lower-case underscore compound variables or camel case compound variables. Once a decision has been made, it must stay consistent throughout the project. In general, if using a framework, try to use whatever format the framework uses. That said, multi-word variable names should be discouraged. It is better to refactor variable visibility so that words don’t clash in a scope than try to juggle buffered_text, buffered_word, and buffered_reader.
</code></pre>

<h4>INCORRECT</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="err">$</span><span class="n">j</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">foo</span><span class="err">&#39;</span><span class="p">;</span> <span class="c1">// single letter variables should only be used in for() loops</span>
</span><span class='line'><span class="n">Str</span><span class="p">;</span> <span class="c1">// contains uppercase letters</span>
</span><span class='line'><span class="n">bufferedText</span><span class="p">;</span> <span class="c1">// Could be shortened without losing semantic meaning</span>
</span><span class='line'><span class="n">groupid</span><span class="p">;</span> <span class="c1">// multiple words, needs underscore separator or camel casing</span>
</span><span class='line'><span class="err">$</span><span class="n">name_of_last_city_used</span><span class="p">;</span> <span class="c1">// too long</span>
</span></code></pre></td></tr></table></div></figure>


<h4>CORRECT</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="k">for</span> <span class="p">(</span><span class="err">$</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="err">$</span><span class="n">j</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="err">$</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
</span><span class='line'><span class="err">$</span><span class="n">str</span>
</span><span class='line'><span class="n">buffer</span>
</span><span class='line'><span class="n">group_id</span><span class="p">,</span> <span class="n">groupID</span>
</span><span class='line'><span class="err">$</span><span class="n">last_city</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Commenting</h3>

<p>In general, code should be commented prolifically. It not only helps describe the flow and intent of the code for less experienced programmers, but can prove invaluable when returning to your own code months down the line. Functions and classes must always have a DocBlock style comment. This includes private members. Sure, your users might only need the API, but your maintainers will really appreciate a comment saying the private _expand method implements a hacked LL(1) parser because the COTS LALR parser was too slow. DocBlock style comments preceding class and method declarations so they can be picked up by IDEs in all languages:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm">* Super Class</span>
</span><span class='line'><span class="cm">*</span>
</span><span class='line'><span class="cm">* @package Package Name</span>
</span><span class='line'><span class="cm">* @subpackage Subpackage</span>
</span><span class='line'><span class="cm">* @category Category</span>
</span><span class='line'><span class="cm">* @author Author Name</span>
</span><span class='line'><span class="cm">* @link http://example.com</span>
</span><span class='line'><span class="cm">*/</span>
</span><span class='line'><span class="n">class</span> <span class="n">SuperClass</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm">* Encodes string for use in XML</span>
</span><span class='line'><span class="cm">*</span>
</span><span class='line'><span class="cm">* @access public</span>
</span><span class='line'><span class="cm">* @param string</span>
</span><span class='line'><span class="cm">* @return string</span>
</span><span class='line'><span class="cm">*/</span>
</span><span class='line'><span class="n">function</span> <span class="n">xml_encode</span><span class="p">(</span><span class="err">$</span><span class="n">str</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Javascript Exception: In Javascript, the DocBlock should be placed BETWEEN the function declaration and the function’s opening brace. This makes the comment a syntactic part of the function, and when a developer passes the function to console.log, the comment will be included in the output.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">var</span> <span class="n">xml_encode</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="err">$</span><span class="n">str</span><span class="p">)</span>
</span><span class='line'>    <span class="cm">/**</span>
</span><span class='line'><span class="cm">    * Encodes string for use in XML</span>
</span><span class='line'><span class="cm">    *</span>
</span><span class='line'><span class="cm">    * @access public</span>
</span><span class='line'><span class="cm">    * @param string</span>
</span><span class='line'><span class="cm">    * @return string</span>
</span><span class='line'><span class="cm">    */</span>
</span><span class='line'>    <span class="p">{</span>
</span></code></pre></td></tr></table></div></figure>


<pre><code>Use single line comments within code, leaving a blank line between large comment blocks and code.
</code></pre>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="c1">// break up the string by newlines</span>
</span><span class='line'><span class="err">$</span><span class="n">parts</span> <span class="o">=</span> <span class="n">explode</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="err">$</span><span class="n">str</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// A longer comment that needs to give greater detail on what is</span>
</span><span class='line'><span class="c1">// occurring and why can use multiple single-line comments.  Try to</span>
</span><span class='line'><span class="c1">// keep the width reasonable, around 70 characters is the easiest to</span>
</span><span class='line'><span class="c1">// read.  Don&#39;t hesitate to link to permanent external resources</span>
</span><span class='line'><span class="c1">// that may provide greater detail:</span>
</span><span class='line'><span class="c1">//</span>
</span><span class='line'><span class="c1">// http://example.com/information_about_something/in_particular/</span>
</span><span class='line'>
</span><span class='line'><span class="err">$</span><span class="n">parts</span> <span class="o">=</span> <span class="err">$</span><span class="n">this</span><span class="o">-&gt;</span><span class="n">foo</span><span class="p">(</span><span class="err">$</span><span class="n">parts</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>As stated in the Indent Style section, control structures should always have a one-line comment on why they are necessary.</p>

<h3>Constants</h3>

<pre><code>Constants follow the same guidelines as do variables, except constants should always be fully uppercase and use underscores for spaces.
</code></pre>

<h4>INCORRECT</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">myConstant</span> <span class="c1">// missing underscore separator and not fully uppercase</span>
</span><span class='line'><span class="n">N</span> <span class="c1">// no single-letter constants</span>
</span><span class='line'><span class="n">S_C_VER</span> <span class="c1">// not descriptive</span>
</span></code></pre></td></tr></table></div></figure>


<h4>CORRECT</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">MY_CONSTANT</span>
</span><span class='line'><span class="n">NEWLINE</span>
</span><span class='line'><span class="n">SUPER_CLASS_VERSION</span>
</span></code></pre></td></tr></table></div></figure>


<h3>TRUE, FALSE, NULL, UNDEFINED</h3>

<pre><code>TRUE, FALSE, NULL, and similar keywords should always be either fully uppercase or undercase as the language allows. This is another “choose at the beginning of the project, then be consistent” rules. INCORRECT

```c
if ($foo == true)
$bar = false;
function foo($bar = null)
```

CORRECT

```c
if (TRUE === $foo)
$bar = FALSE;
function foo($bar = NULL)
Logical Operators
```
</code></pre>

<p>Use of || is discouraged as its clarity on some output devices is low (looking like the number 11 for instance). AND is preferred over &amp;&amp; . A space should always precede and follow !. INCORRECT</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="err">$</span><span class="n">foo</span> <span class="o">||</span> <span class="err">$</span><span class="n">bar</span><span class="p">)</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="err">$</span><span class="n">foo</span> <span class="o">&amp;&amp;</span> <span class="err">$</span><span class="n">bar</span><span class="p">)</span> <span class="err"> </span><span class="c1">// okay but not recommended for common syntax highlighting applications</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="err">$</span><span class="n">foo</span><span class="p">)</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="n">is_array</span><span class="p">(</span><span class="err">$</span><span class="n">foo</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<pre><code>CORRECT
</code></pre>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="err">$</span><span class="n">foo</span> <span class="n">OR</span> <span class="err">$</span><span class="n">bar</span><span class="p">)</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="err">$</span><span class="n">foo</span> <span class="n">AND</span> <span class="err">$</span><span class="n">bar</span><span class="p">)</span> <span class="c1">// recommended</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="err">$</span><span class="n">foo</span><span class="p">)</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="n">is_array</span><span class="p">(</span><span class="err">$</span><span class="n">foo</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Comparing Return Values and Typecasting</h3>

<p>Some PHP functions return FALSE on failure, but may also have a valid return value of &ldquo;&rdquo; or 0, which would evaluate to FALSE in loose comparisons. Be explicit by comparing the variable type when using these return values in conditionals to ensure the return value is indeed what you expect, and not a value that has an equivalent loose-type evaluation. Use the same stringency in returning and checking your own variables. Always use === and !==. INCORRECT</p>

<pre><code>[php]
// If 'foo' is at the beginning of the string, strpos will return a 0,
// resulting in this conditional evaluating as TRUE
if (strpos($str, 'foo') == FALSE) ;

function build_string($str = "") {
if ($str == "") // uh-oh!  What if FALSE or the integer 0 is passed as an argument?
{
}
}
[/php]
CORRECT
[php]
if (strpos($str, 'foo') === FALSE);

function build_string($str = "") {
if ("" ===  $str)
{
}
}
[/php]
See also information regarding typecasting, which can be quite useful. Typecasting has a slightly different effect which may be desirable. When casting a variable as a string, for instance, NULL and boolean FALSE variables become empty strings, 0 (and other numbers) become strings of digits, and boolean TRUE becomes “1”.
</code></pre>

<h4>Example</h4>

<p>[php]
$str = (string) $str; // cast $str as a string
[/php]</p>

<h3>One File per Class</h3>

<pre><code>Use separate files for each class, unless the classes are very closely related. An example of Design Delegates files that contains multiple classes is the Datagrid class file, which contains both the Datagrid class and the Datagrid Template classes.
</code></pre>

<h3>Whitespace</h3>

<pre><code>Use tabs for leading whitespace, not spaces. This may seem like a small thing, but using tabs instead of whitespace allows the developer looking at your code to have indentation at levels that they prefer and customize in whatever application they use. And as a side benefit, it results in (slightly) more compact files, storing one tab character versus, say, four space characters. Use regular spaces inside text for ascii art. The exception is the tab preceding a closing } in CSS declarations, and a tab between a single-line { and its comment in a block of C-style code.
</code></pre>

<h3>Condition Tests</h3>

<pre><code>Condition Tests should be var op test, to avoid assigning the test to the variable.  Short circuit logical operators should use AND, OR, and ! instead of &amp;&amp;, ||, and NOT. Liberal use of parenthesis to guarantee order of operations is needed (no more than one operation in an expression block). INCORRECT
[php]
if($var == 0);
if(term == strpos(haytack, ‘needle’);
[/php]
CORRECT
[php]
if(0 === $var);
if(strpos(haytack, ‘needle’) &gt; -1);
[/php]


&lt;h3&gt;Bracket and Parenthetic Spacing&lt;/h3&gt;


In general, parenthesis and brackets should not use any additional spaces. The exception is that a space should always follow PHP control structures that accept arguments with parenthesis (declare, do-while, elseif, for, foreach, if, switch, while), to help distinguish them from functions and increase readability. INCORRECT
[php]
$arr[ $foo ] = 'foo';
function foo ( $bar ) {
}
foreach( $query-&gt;result() as $row )
[/php]
CORRECT
[php]
$arr[$foo] = 'foo'; // no spaces around array keys

// no spaces around parenthesis in function declarations
function foo($bar) {
}
foreach ($query-&gt;result() as $row) // single space following PHP control structures, but not in interior parenthesis
[/php]


&lt;h3&gt;Localized Text&lt;/h3&gt;


Any text that is output in the control panel should use the translation function __. The __ function will be defined in as many languages as possible. Check the language specific documentation as needed. INCORRECT
```c
return "Invalid Selection";
```
CORRECT
```c
return __('Invalid Selection');
```


&lt;h3&gt;Private Methods and Variables&lt;/h3&gt;


Methods and variables that are only accessed internally by your class, such as utility and helper functions that your public methods use for code abstraction, should be prefixed with an underscore. Use language constructs as appropriate to enforce visibility constraints.
</code></pre>

<h4>Example</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'> <span class="n">class</span> <span class="n">Some_Class</span> <span class="p">{</span>
</span><span class='line'> <span class="n">public</span> <span class="n">function</span> <span class="n">convert_text</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'> <span class="p">}</span>
</span><span class='line'> <span class="n">private</span> <span class="n">function</span> <span class="n">_convert_text</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'> <span class="p">}</span>
</span><span class='line'> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>One Statement Per Line</h3>

<pre><code>Never combine statements on one line. Exception: Variable declaration and initialization, which can be one per type and initial value. In this case, variables should be listed in alphabetical order.
</code></pre>

<h4>INCORRECT</h4>

<p>[php]
$foo = &lsquo;this&rsquo;; $bar = &lsquo;that&rsquo;; $bat = str_replace($foo, $bar, $bag);
[/php]</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="kt">float</span> <span class="n">z</span> <span class="o">=</span> <span class="mf">1.0f</span><span class="p">;</span>
</span><span class='line'><span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="kt">float</span> <span class="n">r</span> <span class="o">=</span> <span class="n">z</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>CORRECT</h4>

<p>[php]
$foo = &lsquo;this&rsquo;;
$bar = &lsquo;that&rsquo;;
$bat = str_replace($foo, $bar, $bag);
[/php]</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="n">b</span> <span class="o">=</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="kt">int</span> <span class="n">m</span> <span class="o">=</span> <span class="n">n</span> <span class="o">=</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span><span class='line'><span class="kt">float</span> <span class="n">r</span> <span class="o">=</span> <span class="n">ratio</span> <span class="o">=</span> <span class="n">z</span> <span class="o">=</span> <span class="mf">1.0f</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">admin</span></span>

      








  


<time datetime="2011-08-14T00:35:38-04:00" pubdate data-updated="true">Aug 14<span>th</span>, 2011</time>
      

<span class="categories">
  
    <a class='category' href='/categories/coding-standards/'>Coding Standards</a>, <a class='category' href='/categories/technology/'>Technology</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://DavidSouther.github.io/2011/08/14/improved-allman-style/" data-via="david_souther" data-counturl="http://DavidSouther.github.io/2011/08/14/improved-allman-style/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2011/08/14/css-written-right/" title="Previous Post: CSS Written Right">&laquo; CSS Written Right</a>
      
      
        <a class="basic-alignment right" href="/2011/08/14/gedit-tips-tricks/" title="Next Post: gedit Tips & Tricks">gedit Tips & Tricks &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    
<section>
  <h1>Stack Overflow Answers</h1>
  <ul id="stackoverflow">
    <li class="loading">Answers updating...</li>
  </ul>
  <script type="text/javascript">
    $(function(){
      getStackOverflowFeed("240358", 7);
    });
  </script>
  <script src="/javascripts/stackoverflow.js" type="text/javascript"> </script>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2013/10/30/testing-its-hard-just-do-it/">Testing. It's Hard. Just Do It!</a>
      </li>
    
      <li class="post">
        <a href="/2013/04/25/sitting-at-home/">Sitting at Home, Listening to Beethoven, Thinking of Maenee</a>
      </li>
    
      <li class="post">
        <a href="/2013/03/18/national-gallery-west-building/">National Gallery, West Building</a>
      </li>
    
      <li class="post">
        <a href="/2013/03/14/7th-ave-between-the-square-and-the-park/">7th Ave Between the Square and the Park</a>
      </li>
    
      <li class="post">
        <a href="/2013/02/25/readable-d3/">Readable D3</a>
      </li>
    
      <li class="post">
        <a href="/2013/01/11/this-rationalists-world-view/">This Rationalist's World-View</a>
      </li>
    
      <li class="post">
        <a href="/2012/12/07/observers-in-my-syntax/">Observers? In *my* Syntax?</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/DavidSouther">@DavidSouther</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'DavidSouther',
            count: 7,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/davidsouther?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - David Souther <davidsouther@gmail.com> -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
